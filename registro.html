<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <title>Registro - VivaPanamá</title>
    <link rel="stylesheet" href="css/estilo.css">
    <link rel="stylesheet" href="css/registro.css">
</head>

<body>
    <div class="form-container">
        <h2>Crear Cuenta</h2>

        <input type="text" id="nombre_usuario" placeholder="Nombre de usuario">
        <input type="password" id="password" placeholder="Contraseña">
        <input type="email" id="email" placeholder="Correo electrónico">
        <input type="text" id="cedula" placeholder="Cédula o pasaporte">
        <input type="number" id="edad" placeholder="Edad">

        <button onclick="registrar()">Registrarse</button>

        <div id="mensaje"></div>

        <div class="login-link">
            ¿Ya tienes cuenta?
            <a href="login.html">Inicia sesión</a>
        </div>
    </div>

<script>
async function registrar() {
    const nombre = document.getElementById("nombre_usuario").value.trim();
    const pass = document.getElementById("password").value.trim();
    const email = document.getElementById("email").value.trim();
    const cedula = document.getElementById("cedula").value.trim();
    const edad = document.getElementById("edad").value.trim();
    const mensaje = document.getElementById("mensaje");

    mensaje.innerHTML = "";
    mensaje.className = "";

    if (!nombre || !pass) {
        mensaje.innerHTML = "Nombre de usuario y contraseña son obligatorios.";
        mensaje.className = "error";
        return;
    }

    try {
        const resp = await fetch("https://localhost:7029/api/Usuarios/registrar", {
    method: "POST",
    headers: { "Content-Type": "application/json" },
    body: JSON.stringify({
        nombre: nombre,
        password: pass,
        email: email,
        cedula_pasaporte: cedula,
        edad: parseInt(edad),
        tipo_usuario: "cliente"
    })
});


        const text = await resp.text();

        if (!resp.ok) {
            mensaje.innerHTML = text;
            mensaje.className = "error";
            return;
        }

        mensaje.innerHTML = "Registro exitoso. Redirigiendo...";
        mensaje.className = "success";

        setTimeout(() => {
            window.location.href = "login.html";
        }, 1500);

    } catch (error) {
        mensaje.innerHTML = "Error al conectar con la API.";
        mensaje.className = "error";
    }
}
</script>

</body>
</html>